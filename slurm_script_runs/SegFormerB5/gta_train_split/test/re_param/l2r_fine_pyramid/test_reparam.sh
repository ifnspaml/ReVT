#!/bin/bash

##GENERAL -----
#SBATCH --cpus-per-task=2
#SBATCH --gres=gpu
#SBATCH --mem=32000M
#SBATCH --ntasks=1
#SBATCH --ntasks-per-node=1

##DEBUG -----
##SBATCH --partition=debug
##SBATCH --time=00:20:00

##NORMAL -----
#SBATCH --partition=gpu
#SBATCH --time=7-00:00:00
#SBATCH --exclude=gpu[04,02,05,01]

######################################################################################
### Parameters:

## Name of the job script
#SBATCH --job-name=SegFo_B5_gta_base_encodersoup_l2r_pyramid_test_abc

## Name of the log file
#SBATCH --output=test_abc-%j.out

## The config that is used for training and testing
main_config="./local_configs/segformer/B5/segformer.b5.512x512.gta2cs.40k.batch2.py"

## The name of the working dir where the results are saved. at the end the prefix "_[a..z]" is added.
declare -a work_dirs=("./work_dirs/gta_train_split/segformer.b5.512x512.gta2cs.40k.batch2_base_a/latest.pth"
                      "./work_dirs/gta_train_split/segformer.b5.512x512.gta2cs.40k.batch2_base_b/latest.pth"
                      "./work_dirs/gta_train_split/segformer.b5.512x512.gta2cs.40k.batch2_base_c/latest.pth")

declare -a merge_orders=("0;1;2" "1;2;0" "2;0;1")
## Defines the target domains on which the models are evaluated after training
test_cityscapes=false
test_cityscapes_val=true
test_bdd=false
test_mapillary=false
test_acdc=false
test_kitti=false
test_synthia=false
test_gta_val=false
test_synthia_val=false

declare -a regexes=('(backbone.*patch_embed1\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)|(backbone\.norm3\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)|(backbone\.norm3\..*)|(backbone.*patch_embed4\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)|(backbone\.norm3\..*)|(backbone.*patch_embed4\..*)|(backbone\.block4\.0\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)|(backbone\.norm3\..*)|(backbone.*patch_embed4\..*)|(backbone\.block4\.0\..*)|(backbone\.block4\.1\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)|(backbone\.norm3\..*)|(backbone.*patch_embed4\..*)|(backbone\.block4\.0\..*)|(backbone\.block4\.1\..*)|(backbone\.block4\.2\..*)' \
'(backbone.*patch_embed1\..*)|(backbone\.block1\.0\..*)|(backbone\.block1\.1\..*)|(backbone\.block1\.2\..*)|(backbone\.norm1\..*)|(backbone.*patch_embed2\..*)|(backbone\.block2\.0\..*)|(backbone\.block2\.1\..*)|(backbone\.block2\.2\..*)|(backbone\.block2\.3\..*)|(backbone\.block2\.4\..*)|(backbone\.block2\.5\..*)|(backbone\.norm2\..*)|(backbone.*patch_embed3\..*)|(backbone\.block3\.0\..*)|(backbone\.block3\.1\..*)|(backbone\.block3\.2\..*)|(backbone\.block3\.3\..*)|(backbone\.block3\.4\..*)|(backbone\.block3\.5\..*)|(backbone\.block3\.6\..*)|(backbone\.block3\.7\..*)|(backbone\.block3\.8\..*)|(backbone\.block3\.9\..*)|(backbone\.block3\.10\..*)|(backbone\.block3\.11\..*)|(backbone\.block3\.12\..*)|(backbone\.block3\.13\..*)|(backbone\.block3\.14\..*)|(backbone\.block3\.15\..*)|(backbone\.block3\.16\..*)|(backbone\.block3\.17\..*)|(backbone\.block3\.18\..*)|(backbone\.block3\.19\..*)|(backbone\.block3\.20\..*)|(backbone\.block3\.21\..*)|(backbone\.block3\.22\..*)|(backbone\.block3\.23\..*)|(backbone\.block3\.24\..*)|(backbone\.block3\.25\..*)|(backbone\.block3\.26\..*)|(backbone\.block3\.27\..*)|(backbone\.block3\.28\..*)|(backbone\.block3\.29\..*)|(backbone\.block3\.30\..*)|(backbone\.block3\.31\..*)|(backbone\.block3\.32\..*)|(backbone\.block3\.33\..*)|(backbone\.block3\.34\..*)|(backbone\.block3\.35\..*)|(backbone\.block3\.36\..*)|(backbone\.block3\.37\..*)|(backbone\.block3\.38\..*)|(backbone\.block3\.39\..*)|(backbone\.norm3\..*)|(backbone.*patch_embed4\..*)|(backbone\.block4\.0\..*)|(backbone\.block4\.1\..*)|(backbone\.block4\.2\..*)|(backbone\.norm4\..*)')

######################################################################################

# Load modules
module load comp/gcc/11.2.0
source activate transformer-domain-generalization

# Extra output
nvidia-smi
echo -e "Node: $(hostname)"
echo -e "Job internal GPU id(s): $CUDA_VISIBLE_DEVICES"
echo -e "Job external GPU id(s): ${SLURM_JOB_GPUS}"


# Define variables for Test dataset
declare -a dataset_names=()
declare -a dataset_types=()
declare -a dataset_data_root=()
declare -a dataset_img_dir=()
declare -a dataset_ann_dir=()
declare -a data_test_split=()

if [ "$test_cityscapes" = true ] ; then
    dataset_names+=("Cityscapes")
    dataset_types+=("CityscapesDataset")
    dataset_data_root+=("data/cityscapes/")
    dataset_img_dir+=("leftImg8bit/val")
    dataset_ann_dir+=("gtFine/val")
    data_test_split+=("")
fi
if [ "$test_cityscapes_val" = true ] ; then
    dataset_names+=("Cityscapes_val")
    dataset_types+=("CityscapesDataset")
    dataset_data_root+=("data/")
    dataset_img_dir+=("cityscapes/leftImg8bit/train")
    dataset_ann_dir+=("cityscapes/gtFine/train")
    data_test_split+=("data.test.split=\"cs_splits/val_split.txt\"")
fi
if [ "$test_bdd" = true ] ; then
    dataset_names+=("bdd")
    dataset_types+=("BDD100kDataset")
    dataset_data_root+=("data/bdd100k/")
    dataset_img_dir+=("images/val")
    dataset_ann_dir+=("labels/val")
    data_test_split+=("")
fi
if [ "$test_mapillary" = true ] ; then
    dataset_names+=("mapillary")
    dataset_types+=("MapillaryDataset")
    dataset_data_root+=("data/mapillary/")
    dataset_img_dir+=("validation/ColorImage")
    dataset_ann_dir+=("segmentation_trainid/validation/Segmentation")
    data_test_split+=("")
fi
if [ "$test_acdc" = true ] ; then
    dataset_names+=("acdc")
    dataset_types+=("ACDCDataset")
    dataset_data_root+=("data/acdc/")
    dataset_img_dir+=("rgb_anon/val")
    dataset_ann_dir+=("gt/val")
    data_test_split+=("")
fi
if [ "$test_kitti" = true ] ; then
    dataset_names+=("kitti")
    dataset_types+=("KITTI2015Dataset")
    dataset_data_root+=("data/kitti/")
    dataset_img_dir+=("images/validation")
    dataset_ann_dir+=("labels/validation")
    data_test_split+=("")
fi
if [ "$test_synthia" = true ] ; then
    dataset_names+=("synthia")
    dataset_types+=("SynthiaDataset")
    dataset_data_root+=("data/synthia/")
    dataset_img_dir+=("RGB")
    dataset_ann_dir+=("GT/LABELS/LABELS")
    data_test_split+=("")
fi
if [ "$test_gta_val" = true ] ; then
    dataset_names+=("gta_val")
    dataset_types+=("GTADataset")
    dataset_data_root+=("data/")
    dataset_img_dir+=("gta/images")
    dataset_ann_dir+=("gta/labels")

    data_test_split+=("data.test.split=\"gta_splits/val_split.txt\"")
fi
if [ "$test_synthia_val" = true ] ; then
    dataset_names+=("synthia_val")
    dataset_types+=("SynthiaDataset")
    dataset_data_root+=("data/")
    dataset_img_dir+=("synthia/RGB")
    dataset_ann_dir+=("synthia/GT/LABELS/LABELS")
    data_test_split+=("data.test.split=\"synthia_splits/val_split.txt\"")
fi
echo -e "Test Datasets:"
for dataset_idx in "${!dataset_names[@]}"; do
    echo -e "   ${dataset_names[dataset_idx]}"
done

declare -a checkpoints_merged=()
for i in "${!merge_orders[@]}"; do
    rand_str=$(echo $RANDOM | md5sum | head -c 20; echo;)
    checkpoints_merged+=("./work_dirs/model_reparametrization/tmp_$rand_str.pth")
done

# Execute programs
cd ~/work/transformer-domain-generalization || return

## Re-Param
for regex_idx in "${!regexes[@]}"; do
  echo -e "Test for Regex: ${regexes[regex_idx]}"
  for i in "${!merge_orders[@]}"; do
    IFS=";" read -r -a order <<< "${merge_orders[i]}"
    checkpoints_str=""
    for j in "${!order[@]}"; do
        checkpoints_str+=" ${work_dirs["${order[j]}"]}"
    done
    srun python tools/model_reparametrization.py\
     "${checkpoints_merged[i]}"\
     --checkpoints\
        $(echo -n "$checkpoints_str")\
     --weights-filter "${regexes[regex_idx]}"
    echo -e "Finished Re-Param ${i}"
  done

  ## evaluate the models
  for dataset_idx in "${!dataset_names[@]}"; do
    echo -e "Test all on ${dataset_names[dataset_idx]}"
    for checkpoint_idx in "${!checkpoints_merged[@]}"; do

      echo -e "Test for ${checkpoint_idx}:"
      srun python ./tools/test.py\
       "${main_config}"\
       "${checkpoints_merged[checkpoint_idx]}"\
       --gpu-collect\
       --eval-options efficient_test='True'\
       --no-progress-bar\
       --options \
          data.test.type="${dataset_types[dataset_idx]}"\
          dataset_type="${dataset_types[dataset_idx]}"\
          data_root="${dataset_data_root[dataset_idx]}"\
          data.test.data_root="${dataset_data_root[dataset_idx]}"\
          data.test.img_dir="${dataset_img_dir[dataset_idx]}"\
          data.test.ann_dir="${dataset_ann_dir[dataset_idx]}"\
          $(echo -n "${data_test_split[dataset_idx]}")
      echo -e "___________________________________________________"

    done
  done
done

for i in "${!checkpoints_merged[@]}"; do
    rm "${checkpoints_merged[i]}"
done